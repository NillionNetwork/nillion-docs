import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# Usage

Once you have [nilAI API access](/blind-computer/build/network-api-access), you can start using LLMs on nilAI nodes with any OpenAI-compatible library.

## Getting Started with Private LLMs

<Tabs>

    <TabItem value="python" label="Python">
        <Tabs>
            <TabItem value="pip" label="pip" default>
                ```bash
                pip install nilai-py
                ```
            </TabItem>
            <TabItem value="uv" label="uv">
                ```bash
                uv pip install nilai-py
                ```
            </TabItem>
        </Tabs>
    </TabItem>
    <TabItem value="typescript" label="TypeScript" default>
        ```bash
        pnpm install @nillion/nilai-ts
        ```
    </TabItem>

</Tabs>

You can either use:

- `API Key` flow as the sole developer / organization or
- `Direct Signing.` to provide permissions to another user / organization.

### API Key Flow

1. Use `https://nilai-a779.nillion.network/v1` as the BASE URL
2. Check [available models](/blind-computer/build/llms/overview#available-models) or query the [`/v1/models`](/api/nilai/get-models-v-1-models-get) endpoint or
3. Select an available model and use it with the [`/v1/chat/completions`](/api/nilai/chat-completion-v-1-chat-completions-post) nilAI node endpoint

With OpenAI compatibility, you can use any OpenAI library. Here's an example for querying the `gemma-3-27b-it` model:

<Tabs>
    <TabItem value="python" label="Python">
        ```python reference showGithubLink
        https://github.com/NillionNetwork/blind-module-examples/blob/main/nilai/secretllm_python_nucs/api_key_mode.py
        ```
    </TabItem>
    <TabItem value="typescript" label="Typescript" default>
        ```typescript
        import "dotenv/config";
        import { NilaiOpenAIClient, NilAuthInstance } from "@nillion/nilai-ts";

        // To obtain an API key, navigate to https://subscription.nillion.com
        // and create a new subscription.
        // The API key will be displayed in the subscription details.
        // The NilaiOpenAIClient class automatically handles the NUC token creation and management.

        const API_KEY = process.env.NILLION_API_KEY;

        async function main() {
        // Initialize the client in API key mode
        // For sandbox, use the following:
        const client = new NilaiOpenAIClient({
            baseURL: "https://nilai-a779.nillion.network/v1/",
            apiKey: API_KEY,
            nilauthInstance: NilAuthInstance.SANDBOX,
            // For production, use the following:
            // nilauthInstance: NilAuthInstance.PRODUCTION,
        });

        // Make a request to the Nilai API
        const response = await client.chat.completions.create({
            model: "google/gemma-3-27b-it",
            messages: [
            { role: "user", content: "Hello! Can you help me with something?" }
            ],
        });

        console.log(`Response: ${response.choices[0].message.content}`);
        }

        // Run the example
        main().catch(console.error);
        ```
    </TabItem>

</Tabs>

### Direct Signing.

To use the direct signing flow, you need to create a delegation token server.

The server creates delegation tokens and manages their expiration and usage. Then the delegation token allows clients to make requests to the nilAI API.

<Tabs>
    <TabItem value="nextjs-nucs" label="Next.js" default>
        This flow matches the older `secretllm_nextjs_nucs` tutorial:

        1. Server initializes `DelegationTokenServer` with `expirationTime` and `tokenMaxUses`.
        2. Client initializes `NilaiOpenAIClient` with `authType: AuthType.DELEGATION_TOKEN`.
        3. Client produces a delegation request with `client.getDelegationRequest()`.
        4. Server creates the delegation token with `server.createDelegationToken(...)`.
        5. Client sets the token with `client.updateDelegation(...)`.
        6. Client uses the delegation token to call chat completions and reads `response.choices[0].message.content`.

        ```typescript reference showGithubLink
        https://github.com/NillionNetwork/blind-module-examples/blob/main/nilai/secretllm_nextjs_nucs/app/api/chat-delegation/route.ts
        ```
    </TabItem>
    <TabItem value="python" label="Python">
        ```python reference showGithubLink
        https://github.com/NillionNetwork/blind-module-examples/blob/main/nilai/secretllm_python_nucs/delegation_acess_mode.py
        ```
    </TabItem>
    <TabItem value="typescript" label="Typescript">
        ```typescript reference showGithubLink
        https://github.com/NillionNetwork/nilai-ts/blob/main/examples/1-delegation-token.ts
        ```
    </TabItem>
</Tabs>
